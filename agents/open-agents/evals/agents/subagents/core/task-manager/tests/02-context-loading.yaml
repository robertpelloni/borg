id: core-task-manager-context-loading
name: "Task Manager: Context Loading - Load Context Before Planning"
description: |
  Tests the task-manager's critical requirement to load context before
  creating task breakdowns.
  
  Validates:
  - Checks for context bundle first
  - Loads context files if available
  - Applies context to task planning
  - References loaded context in plan
  
  Critical Behavior:
  - MUST check for context bundle (.tmp/context/{session}/bundle.md)
  - MUST load project standards before planning
  - MUST apply context to task breakdown
  - MUST list context files used in plan
category: developer

prompts:
  - text: |
      Break down a feature for "user authentication" into subtasks. Before you
      start planning, check if there's a context bundle at
      .tmp/test-fixtures/task-manager/bundle.md and load it if it exists.

approvalStrategy:
  type: auto-approve

behavior:
  mustUseTools:
    - read
  minToolCalls: 1
  maxToolCalls: 10

expectedViolations:
  - rule: approval-gate
    shouldViolate: false
    severity: error
  - rule: context-loading
    shouldViolate: false
    severity: error

timeout: 120000

tags:
  - task-manager
  - context-loading
  - critical-rule
  - core-subagent
  - planning
